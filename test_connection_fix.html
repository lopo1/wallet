<!DOCTYPE html>
<html>
<head>
    <title>DAppè¿æ¥æµ‹è¯•</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        button { padding: 10px 20px; margin: 10px; font-size: 16px; }
        .result { margin: 10px 0; padding: 10px; background: #f0f0f0; }
        .error { background: #ffebee; color: #c62828; }
        .success { background: #e8f5e8; color: #2e7d32; }
    </style>
</head>
<body>
    <h1>DAppè¿æ¥æµ‹è¯•é¡µé¢</h1>
    
    <div>
        <button onclick="checkProvider()">æ£€æŸ¥Provider</button>
        <button onclick="connectWallet()">è¿æ¥é’±åŒ…</button>
        <button onclick="getAccounts()">è·å–è´¦æˆ·</button>
        <button onclick="getChainId()">è·å–é“¾ID</button>
    </div>
    
    <div id="results"></div>

    <script>
        function log(message, isError = false) {
            const div = document.createElement('div');
            div.className = 'result ' + (isError ? 'error' : 'success');
            div.textContent = new Date().toLocaleTimeString() + ': ' + message;
            document.getElementById('results').appendChild(div);
            console.log(message);
        }

        function checkProvider() {
            if (typeof window.ethereum !== 'undefined') {
                log('âœ… Ethereum provider found');
                log('Provider info: ' + JSON.stringify({
                    isMetaMask: window.ethereum.isMetaMask,
                    isHarbor: window.ethereum.isHarbor,
                    isFlutterWallet: window.ethereum.isFlutterWallet,
                    chainId: window.ethereum.chainId,
                    selectedAddress: window.ethereum.selectedAddress
                }));
            } else {
                log('âŒ No Ethereum provider found', true);
            }
        }

        async function connectWallet() {
            try {
                log('ğŸ”„ Requesting wallet connection...');
                const accounts = await window.ethereum.request({ 
                    method: 'eth_requestAccounts' 
                });
                log('âœ… Connected! Accounts: ' + JSON.stringify(accounts));
            } catch (error) {
                log('âŒ Connection failed: ' + error.message, true);
            }
        }

        async function getAccounts() {
            try {
                const accounts = await window.ethereum.request({ 
                    method: 'eth_accounts' 
                });
                log('âœ… Accounts: ' + JSON.stringify(accounts));
            } catch (error) {
                log('âŒ Get accounts failed: ' + error.message, true);
            }
        }

        async function getChainId() {
            try {
                const chainId = await window.ethereum.request({ 
                    method: 'eth_chainId' 
                });
                log('âœ… Chain ID: ' + chainId);
            } catch (error) {
                log('âŒ Get chain ID failed: ' + error.message, true);
            }
        }

        // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨æ£€æŸ¥
        window.addEventListener('load', () => {
            setTimeout(checkProvider, 1000);
        });
    </script>
</body>
</html>