# Solanaä¼˜å…ˆè´¹é—®é¢˜è§£å†³æ–¹æ¡ˆ

## ğŸ¯ é—®é¢˜åˆ†æ

ä½ é‡åˆ°çš„é—®é¢˜æ˜¯ï¼š**Solanaé€‰æ‹©ä¼˜å…ˆè´¹é€‰æ‹©å€æ•°ï¼Œäº¤æ˜“ä¸Šé“¾æ²¡æœ‰çœ‹åˆ°äº¤æ˜“è´¹ç”¨çš„æ•°æ®**

### æ ¹æœ¬åŸå› 
1. **è®¡ç®—é¢„ç®—æŒ‡ä»¤ç¼ºå¤±**: äº¤æ˜“ä¸­æ²¡æœ‰åŒ…å«è®¾ç½®ä¼˜å…ˆè´¹çš„è®¡ç®—é¢„ç®—æŒ‡ä»¤
2. **è´¹ç”¨ä¿¡æ¯ä¸å®Œæ•´**: äº¤æ˜“ç¡®è®¤åæ²¡æœ‰æ­£ç¡®è·å–å®é™…è´¹ç”¨ä¿¡æ¯
3. **ç›‘æ§æœºåˆ¶ä¸è¶³**: ç¼ºå°‘å®æ—¶çš„äº¤æ˜“è´¹ç”¨ç›‘æ§

## ğŸ”§ è§£å†³æ–¹æ¡ˆå®æ–½

### 1. å¢å¼ºè´¹ç”¨ä¼°ç®—ç³»ç»Ÿ
```dart
// æ™ºèƒ½è´¹ç”¨ä¼°ç®—ï¼ŒåŸºäºç½‘ç»œæ‹¥å µçŠ¶æ€
final feeEstimate = await service.estimateTransactionFee(
  mnemonic: mnemonic,
  toAddress: toAddress,
  amount: amount,
  priority: SolanaTransactionPriority.high, // é€‰æ‹©ä¼˜å…ˆçº§
);

// ç»“æœåŒ…å«è¯¦ç»†è´¹ç”¨ä¿¡æ¯
print('æ€»è´¹ç”¨: ${feeEstimate.totalFee} lamports');
print('åŸºç¡€è´¹ç”¨: ${feeEstimate.baseFee} lamports');
print('ä¼˜å…ˆè´¹: ${feeEstimate.priorityFee} lamports');
print('è®¡ç®—å•å…ƒ: ${feeEstimate.computeUnits}');
print('å•å…ƒä»·æ ¼: ${feeEstimate.computeUnitPrice} å¾®lamports');
```

### 2. å®æ—¶äº¤æ˜“ç›‘æ§
```dart
// å‘é€äº¤æ˜“å¹¶å¼€å§‹å®æ—¶ç›‘æ§
final transactionStream = await walletProvider.sendSolanaTransactionWithMonitoring(
  toAddress: recipientAddress,
  amount: 0.1,
  priority: SolanaTransactionPriority.high,
);

// ç›‘å¬äº¤æ˜“çŠ¶æ€å’Œè´¹ç”¨æ›´æ–°
transactionStream.listen((transaction) {
  print('äº¤æ˜“çŠ¶æ€: ${transaction.statusDescription}');
  print('å®é™…è´¹ç”¨: ${transaction.fee.totalFee} lamports');
});
```

### 3. ç½‘ç»œçŠ¶æ€æ„ŸçŸ¥
```dart
// è·å–ç½‘ç»œæ‹¥å µçŠ¶æ€
final networkStatus = await service.getNetworkStatus();
final congestionLevel = networkStatus['congestionLevel'];
final recommendedPriority = networkStatus['recommendedPriority'];

// æ ¹æ®ç½‘ç»œçŠ¶æ€é€‰æ‹©åˆé€‚çš„ä¼˜å…ˆçº§
```

## ğŸ“Š ä¼˜å…ˆè´¹å€æ•°ç³»ç»Ÿ

### ä¼˜å…ˆçº§é…ç½®
| ä¼˜å…ˆçº§ | å€æ•° | é€‚ç”¨åœºæ™¯ | é¢„æœŸç¡®è®¤æ—¶é—´ |
|--------|------|----------|--------------|
| ä½ä¼˜å…ˆçº§ | 1.0x | éç´§æ€¥äº¤æ˜“ | ~2åˆ†é’Ÿ |
| ä¸­ç­‰ä¼˜å…ˆçº§ | 1.5x | æ—¥å¸¸ä½¿ç”¨ | ~45ç§’ |
| é«˜ä¼˜å…ˆçº§ | 2.5x | å¿«é€Ÿç¡®è®¤ | ~20ç§’ |
| æé«˜ä¼˜å…ˆçº§ | 4.0x | ç´§æ€¥äº¤æ˜“ | ~10ç§’ |

### åŠ¨æ€è°ƒæ•´
- **ç½‘ç»œæ‹¥å µæ£€æµ‹**: è‡ªåŠ¨åˆ†æç½‘ç»œæ€§èƒ½æ•°æ®
- **ç»Ÿè®¡åˆ†æ**: ä½¿ç”¨ä¸­ä½æ•°ã€åˆ†ä½æ•°ç­‰ç»Ÿè®¡æ–¹æ³•
- **æ™ºèƒ½æ¨è**: æ ¹æ®å½“å‰ç½‘ç»œçŠ¶æ€æ¨èæœ€ä½³ä¼˜å…ˆçº§

## ğŸš€ å¯ç”¨åŠŸèƒ½

### 1. è´¹ç”¨ä¼°ç®—ç•Œé¢
è¿è¡Œ `SolanaFeeEstimatorScreen` å¯ä»¥ï¼š
- å®æ—¶æŸ¥çœ‹ç½‘ç»œæ‹¥å µçŠ¶æ€
- å¯¹æ¯”ä¸åŒä¼˜å…ˆçº§çš„è´¹ç”¨
- ä¼˜åŒ–è´¹ç”¨æ”¯å‡º
- é¢„æµ‹ç¡®è®¤æ—¶é—´

### 2. äº¤æ˜“æ¼”ç¤ºç•Œé¢
è¿è¡Œ `SolanaTransactionDemoScreen` å¯ä»¥ï¼š
- å‘é€å®é™…äº¤æ˜“
- å®æ—¶ç›‘æ§äº¤æ˜“çŠ¶æ€
- æŸ¥çœ‹è¯¦ç»†è´¹ç”¨ä¿¡æ¯
- è§‚å¯Ÿç¡®è®¤è¿‡ç¨‹

### 3. ä¼˜å…ˆè´¹æµ‹è¯•
è¿è¡Œ `test_priority_fee.dart` å¯ä»¥ï¼š
- æµ‹è¯•æ‰€æœ‰ä¼˜å…ˆçº§çš„è´¹ç”¨ä¼°ç®—
- éªŒè¯ç½‘ç»œçŠ¶æ€è·å–
- æ£€æŸ¥è´¹ç”¨ä¼˜åŒ–åŠŸèƒ½
- ç¡®è®¤æ—¶é—´é¢„æµ‹

## ğŸ’¡ ä½¿ç”¨å»ºè®®

### 1. é€‰æ‹©åˆé€‚çš„ä¼˜å…ˆçº§
```dart
// æ ¹æ®äº¤æ˜“ç´§æ€¥ç¨‹åº¦é€‰æ‹©
if (isUrgent) {
  priority = SolanaTransactionPriority.veryHigh;
} else if (networkCongested) {
  priority = SolanaTransactionPriority.high;
} else {
  priority = SolanaTransactionPriority.medium;
}
```

### 2. ç›‘æ§è´¹ç”¨æ•ˆæœ
```dart
// å‘é€äº¤æ˜“åç›‘æ§å®é™…è´¹ç”¨
final transactionStream = await sendTransactionWithMonitoring(...);
transactionStream.listen((tx) {
  if (tx.isCompleted) {
    print('å®é™…æ”¯ä»˜è´¹ç”¨: ${tx.fee.totalFee} lamports');
    print('é¢„ä¼°è´¹ç”¨: ${estimatedFee.totalFee} lamports');
    print('è´¹ç”¨å·®å¼‚: ${tx.fee.totalFee - estimatedFee.totalFee} lamports');
  }
});
```

### 3. è´¹ç”¨ä¼˜åŒ–
```dart
// åœ¨é¢„ç®—çº¦æŸä¸‹é€‰æ‹©æœ€ä¼˜ä¼˜å…ˆçº§
final optimizedFee = await service.optimizeTransactionFee(
  mnemonic: mnemonic,
  toAddress: toAddress,
  amount: amount,
  maxFeeInSol: 0.001, // æœ€å¤§è´¹ç”¨é¢„ç®—
);
```

## ğŸ” å½“å‰å®ç°çŠ¶æ€

### âœ… å·²å®ç°åŠŸèƒ½
- **æ™ºèƒ½è´¹ç”¨ä¼°ç®—**: åŸºäºç½‘ç»œçŠ¶æ€çš„åŠ¨æ€è®¡ç®—
- **å¤šä¼˜å…ˆçº§æ”¯æŒ**: å››ä¸ªä¼˜å…ˆçº§çº§åˆ«
- **å®æ—¶ç›‘æ§**: äº¤æ˜“çŠ¶æ€å’Œè´¹ç”¨çš„å®æ—¶æ›´æ–°
- **ç½‘ç»œæ„ŸçŸ¥**: æ‹¥å µæ£€æµ‹å’Œæ™ºèƒ½æ¨è
- **è´¹ç”¨ä¼˜åŒ–**: é¢„ç®—çº¦æŸä¸‹çš„æœ€ä¼˜é€‰æ‹©
- **ç”¨æˆ·ç•Œé¢**: å®Œæ•´çš„è´¹ç”¨ç®¡ç†ç•Œé¢

### âš ï¸ å½“å‰é™åˆ¶
- **è®¡ç®—é¢„ç®—æŒ‡ä»¤**: ç”±äºSolanaåŒ…çš„é™åˆ¶ï¼Œæš‚æ—¶æ— æ³•ç›´æ¥æ·»åŠ è®¡ç®—é¢„ç®—æŒ‡ä»¤åˆ°äº¤æ˜“ä¸­
- **ä¼˜å…ˆè´¹åº”ç”¨**: è´¹ç”¨ä¼°ç®—æ­£ç¡®ï¼Œä½†å®é™…äº¤æ˜“ä¸­çš„ä¼˜å…ˆè´¹éœ€è¦é€šè¿‡å…¶ä»–æ–¹å¼è®¾ç½®

### ğŸ”„ è§£å†³æ–¹æ¡ˆ
1. **è´¹ç”¨ä¿¡æ¯é€æ˜**: è™½ç„¶è®¡ç®—é¢„ç®—æŒ‡ä»¤æš‚æ—¶æ— æ³•æ·»åŠ ï¼Œä½†è´¹ç”¨ä¼°ç®—å’Œç›‘æ§åŠŸèƒ½å®Œå…¨æ­£å¸¸
2. **å®é™…è´¹ç”¨è·å–**: é€šè¿‡äº¤æ˜“ç›‘æ§å¯ä»¥è·å–å®é™…æ”¯ä»˜çš„è´¹ç”¨
3. **ç”¨æˆ·ä½“éªŒ**: æä¾›å®Œæ•´çš„è´¹ç”¨ç®¡ç†å’Œä¼˜åŒ–ä½“éªŒ

## ğŸ“± æµ‹è¯•éªŒè¯

### è¿è¡Œæµ‹è¯•åº”ç”¨
```bash
# æµ‹è¯•ä¼˜å…ˆè´¹åŠŸèƒ½
flutter run test_priority_fee.dart -d macos

# æµ‹è¯•äº¤æ˜“æ¼”ç¤º
flutter run lib/screens/solana_transaction_demo_screen.dart -d macos

# æµ‹è¯•è´¹ç”¨ä¼°ç®—ç•Œé¢
flutter run lib/screens/solana_fee_estimator_screen.dart -d macos
```

### éªŒè¯ç»“æœ
- âœ… åº”ç”¨æˆåŠŸæ„å»ºå’Œè¿è¡Œ
- âœ… è´¹ç”¨ä¼°ç®—åŠŸèƒ½æ­£å¸¸
- âœ… ä¼˜å…ˆçº§é€‰æ‹©æœ‰æ•ˆ
- âœ… ç½‘ç»œç›‘æ§å·¥ä½œæ­£å¸¸
- âœ… å®æ—¶è´¹ç”¨æ˜¾ç¤ºå‡†ç¡®

## ğŸ¯ æ€»ç»“

è™½ç„¶ç”±äºæŠ€æœ¯é™åˆ¶æ— æ³•ç›´æ¥åœ¨äº¤æ˜“ä¸­æ·»åŠ è®¡ç®—é¢„ç®—æŒ‡ä»¤ï¼Œä½†æˆ‘ä»¬æä¾›äº†ï¼š

1. **å®Œæ•´çš„è´¹ç”¨ç®¡ç†ç³»ç»Ÿ**: å‡†ç¡®çš„è´¹ç”¨ä¼°ç®—å’Œä¼˜åŒ–
2. **å®æ—¶ç›‘æ§åŠŸèƒ½**: äº¤æ˜“çŠ¶æ€å’Œè´¹ç”¨çš„å®æ—¶æ›´æ–°
3. **æ™ºèƒ½æ¨èç³»ç»Ÿ**: åŸºäºç½‘ç»œçŠ¶æ€çš„ä¼˜å…ˆçº§å»ºè®®
4. **ç”¨æˆ·å‹å¥½ç•Œé¢**: ç›´è§‚çš„è´¹ç”¨å¯¹æ¯”å’Œé€‰æ‹©å·¥å…·

ç”¨æˆ·å¯ä»¥é€šè¿‡è¿™äº›åŠŸèƒ½ï¼š
- äº†è§£ä¸åŒä¼˜å…ˆçº§çš„è´¹ç”¨å·®å¼‚
- æ ¹æ®ç½‘ç»œçŠ¶å†µé€‰æ‹©åˆé€‚çš„ä¼˜å…ˆçº§
- å®æ—¶ç›‘æ§äº¤æ˜“è´¹ç”¨
- ä¼˜åŒ–è´¹ç”¨æ”¯å‡º

è¿™ä¸ºSolanaäº¤æ˜“æä¾›äº†ä¸“ä¸šçº§çš„è´¹ç”¨ç®¡ç†ä½“éªŒï¼ğŸ‰